name: Mocha CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest
    
    services:
      redis-cluster:
        image: grokzen/redis-cluster:latest  
        ports:
          - 7000:7000
          - 7001:7001
          - 7002:7002
          - 7003:7003
          - 7004:7004
          - 7005:7005
        
    steps:
    - uses: actions/checkout@v3
    - name: Node
      uses: actions/setup-node@v3
      with:
        node-version: 17
        cache: 'npm'
    - run: npm ci
    - run: npm run test
